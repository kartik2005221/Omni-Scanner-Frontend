{% extends 'base.html' %}

{% block title %}1 â†’ 2. Fast Nmap Arp Scan{% endblock %}

{% block body %}
    <h1>Fast Nmap ARP Scan Results</h1>
    <div>
        <label for="ip-input">Enter IP Address:</label>
        <input type="text" id="ip-input" class="text-black" placeholder="e.g., 192.168.1.1-255">
        <button id="scan-button">Start Scan</button>
    </div>
    <div id="loading" style="display: none;">
        <button
                class="inline-block rounded-full bg-green-500 text-neutral-50 shadow-[0_4px_9px_-4px_rgba(51,45,45,0.7)] hover:bg-green-600 hover:shadow-[0_8px_9px_-4px_rgba(51,45,45,0.2),0_4px_18px_0_rgba(51,45,45,0.1)] focus:bg-green-800 focus:shadow-[0_8px_9px_-4px_rgba(51,45,45,0.2),0_4px_18px_0_rgba(51,45,45,0.1)] active:bg-green-700 active:shadow-[0_8px_9px_-4px_rgba(51,45,45,0.2),0_4px_18px_0_rgba(51,45,45,0.1)] px-6 pb-2 pt-2.5 text-xs font-medium uppercase leading-normal transition duration-150 ease-in-out focus:outline-none focus:ring-0"
                type="button"
        >
            <div
                    role="status"
                    class="inline-block h-3 w-3 mr-2 animate-spin rounded-full border-2 border-solid border-current border-r-transparent align-[-0.125em] motion-reduce:animate-[spin_1.5s_linear_infinite]"
            >
                <span
                        class="!absolute !-m-px !h-px !w-px !overflow-hidden !whitespace-nowrap !border-0 !p-0 ![clip:rect(0,0,0,0)]"
                >
                    Loading...
                </span>
            </div>
            Running Scan
        </button>
    </div>
    <div id="results"></div>
{% endblock %}

{% block scripts %}
{#    below java dont listen for enter key, and option for submitting is just 1 option,
 by pressing button on side of blank#}
{#    document.addEventListener("DOMContentLoaded", function () {#}
{#    const scanButton = document.getElementById("scan-button");#}
{#    const ipInput = document.getElementById("ip-input");#}
{#    const loading = document.getElementById("loading");#}
{#    const results = document.getElementById("results");#}
{##}
{#    scanButton.addEventListener("click", function () {#}
{#    const ip = ipInput.value.trim();#}
{#    if (!ip) {#}
{#    alert("Please enter a valid IP address.");#}
{#    return;#}
{#    }#}
{##}
{#    // Show loading animation#}
{#    loading.style.display = "block";#}
{#    results.innerHTML = "";#}
{##}
{#    // Fetch ARP scan results#}
{#    fetch(`/api/arp_scan_nmap?ip=${encodeURIComponent(ip)}`)#}
{#    .then((response) => response.json())#}
{#    .then((data) => {#}
{#    // Hide loading animation#}
{#    loading.style.display = "none";#}
{##}
{#    // Display results#}
{#    if (data.success) {#}
{#    results.innerHTML = `<pre>${data.results}</pre>`;#}
{#    } else {#}
{#    results.innerHTML = `<p>Error: ${data.error}</p>`;#}
{#    }#}
{#    })#}
{#    .catch((error) => {#}
{#    loading.style.display = "none";#}
{#    results.innerHTML = `<p>Error: ${error.message}</p>`;#}
{#    });#}
{#    });#}
{#    });#}
    document.addEventListener("DOMContentLoaded", function () {
    const scanButton = document.getElementById("scan-button");
    const ipInput = document.getElementById("ip-input");
    const loading = document.getElementById("loading");
    const results = document.getElementById("results");

    function startScan() {
    const ip = ipInput.value.trim();
    if (!ip) {
    alert("Please enter a valid IP address.");
    return;
    }

    // Show loading animation
    loading.style.display = "block";
    results.innerHTML = "";

    // Fetch ARP scan results
    fetch(`/api/arp_scan_nmap?ip=${encodeURIComponent(ip)}`)
    .then((response) => response.json())
    .then((data) => {
    // Hide loading animation
    loading.style.display = "none";

    // Display results
    if (data.success) {
    results.innerHTML = `<pre>${data.results}</pre>`;
    } else {
    results.innerHTML = `<p>Error: ${data.error}</p>`;
    }
    })
    .catch((error) => {
    loading.style.display = "none";
    results.innerHTML = `<p>Error: ${error.message}</p>`;
    });
    }

    // Trigger scan on button click
    scanButton.addEventListener("click", startScan);

    // Trigger scan on pressing Enter in the input field
    ipInput.addEventListener("keypress", function (event) {
    if (event.key === "Enter") {
    event.preventDefault(); // Prevent form submission or default behavior
    startScan();
    }
    });
    });
{% endblock %}