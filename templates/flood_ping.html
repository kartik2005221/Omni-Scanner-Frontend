{% extends 'base.html' %}

{% block title %}2 → 4. Flood Ping{% endblock %}

{#{% block body %}#}
{#    <h1>Flood Ping Results</h1>#}
{#    <div>#}
{#        <label for="ip-input">Enter IP Address:</label>#}
{#        <input type="text" id="ip-input" class="text-black" placeholder="e.g., 192.168.1.1">#}
{#        <button id="scan-button">Start Scan</button>#}
{#    </div>#}
{#    <div id="loading" style="display: none;">#}
{#        <button#}
{#                class="inline-block rounded-full bg-green-500 text-neutral-50 shadow-[0_4px_9px_-4px_rgba(51,45,45,0.7)] hover:bg-green-600 hover:shadow-[0_8px_9px_-4px_rgba(51,45,45,0.2),0_4px_18px_0_rgba(51,45,45,0.1)] focus:bg-green-800 focus:shadow-[0_8px_9px_-4px_rgba(51,45,45,0.2),0_4px_18px_0_rgba(51,45,45,0.1)] active:bg-green-700 active:shadow-[0_8px_9px_-4px_rgba(51,45,45,0.2),0_4px_18px_0_rgba(51,45,45,0.1)] px-6 pb-2 pt-2.5 text-xs font-medium uppercase leading-normal transition duration-150 ease-in-out focus:outline-none focus:ring-0"#}
{#                type="button"#}
{#        >#}
{#            <div#}
{#                    role="status"#}
{#                    class="inline-block h-3 w-3 mr-2 animate-spin rounded-full border-2 border-solid border-current border-r-transparent align-[-0.125em] motion-reduce:animate-[spin_1.5s_linear_infinite]"#}
{#            >#}
{#                <span#}
{#                        class="!absolute !-m-px !h-px !w-px !overflow-hidden !whitespace-nowrap !border-0 !p-0 ![clip:rect(0,0,0,0)]"#}
{#                >#}
{#                    Loading...#}
{#                </span>#}
{#            </div>#}
{#            infinite Flood Ping running#}
{#        </button>#}
{#    </div>#}
{#    <div id="results"></div>#}
{#    <p>⚠️ Warning: Use With Caution#}
{##}
{#        Flood ping (ping -f) sends a rapid stream of packets and can overwhelm target systems or networks, potentially violating legal or ethical guidelines.#}
{#        Use only on systems you own or have explicit permission to test. Unauthorized usage may be considered illegal.</p>#}
{#{% endblock %}#}
{##}
{#{% block scripts %}#}
{#    document.addEventListener("DOMContentLoaded", function () {#}
{#    const scanButton = document.getElementById("scan-button");#}
{#    const ipInput = document.getElementById("ip-input");#}
{#    const loading = document.getElementById("loading");#}
{#    const results = document.getElementById("results");#}
{##}
{#    function startScan() {#}
{#    const ip = ipInput.value.trim();#}
{#    if (!ip) {#}
{#    alert("Please enter a valid IP address.");#}
{#    return;#}
{#    }#}
{##}
{#    // Show loading animation#}
{#    loading.style.display = "block";#}
{#    results.innerHTML = "";#}
{##}
{#    // Fetch ARP scan results#}
{#    fetch(`/api/flood_ping?ip=${encodeURIComponent(ip)}`)#}
{#    .then((response) => response.json())#}
{#    .then((data) => {#}
{#    // Hide loading animation#}
{#    loading.style.display = "none";#}
{##}
{#    // Display results#}
{#    if (data.success) {#}
{#    results.innerHTML = `<pre>${data.results}</pre>`;#}
{#    } else {#}
{#    results.innerHTML = `<p>Error: ${data.error}</p>`;#}
{#    }#}
{#    })#}
{#    .catch((error) => {#}
{#    loading.style.display = "none";#}
{#    results.innerHTML = `<p>Error: ${error.message}</p>`;#}
{#    });#}
{#    }#}
{##}
{#    // Trigger scan on button click#}
{#    scanButton.addEventListener("click", startScan);#}
{##}
{#    // Trigger scan on pressing Enter in the input field#}
{#    ipInput.addEventListener("keypress", function (event) {#}
{#    if (event.key === "Enter") {#}
{#    event.preventDefault(); // Prevent form submission or default behavior#}
{#    startScan();#}
{#    }#}
{#    });#}
{#    });#}
{#{% endblock %}#}


{% block body %}
    <h1>Flood Ping Results</h1>
    <div>
        <label for="ip-input">Enter IP Address:</label>
        <input type="text" id="ip-input" class="text-black" placeholder="e.g., 192.168.1.1">
        <button id="start-button">Start Scan</button>
        <button id="stop-button" style="display: none;">Stop Scan</button>
    </div>
    <div id="loading" style="display: none;">
        <button
                class="inline-block rounded-full bg-green-500 text-neutral-50 shadow-[0_4px_9px_-4px_rgba(51,45,45,0.7)] hover:bg-green-600 hover:shadow-[0_8px_9px_-4px_rgba(51,45,45,0.2),0_4px_18px_0_rgba(51,45,45,0.1)] focus:bg-green-800 focus:shadow-[0_8px_9px_-4px_rgba(51,45,45,0.2),0_4px_18px_0_rgba(51,45,45,0.1)] active:bg-green-700 active:shadow-[0_8px_9px_-4px_rgba(51,45,45,0.2),0_4px_18px_0_rgba(51,45,45,0.1)] px-6 pb-2 pt-2.5 text-xs font-medium uppercase leading-normal transition duration-150 ease-in-out focus:outline-none focus:ring-0"
                type="button"
        >
            <div
                    role="status"
                    class="inline-block h-3 w-3 mr-2 animate-spin rounded-full border-2 border-solid border-current border-r-transparent align-[-0.125em] motion-reduce:animate-[spin_1.5s_linear_infinite]"
            >
                <span
                        class="!absolute !-m-px !h-px !w-px !overflow-hidden !whitespace-nowrap !border-0 !p-0 ![clip:rect(0,0,0,0)]"
                >
                    Loading...
                </span>
            </div>
            infinite Flood Ping running
        </button>
    </div>
    <div id="results"></div>
    <p>⚠️ Warning: Use With Caution

        Flood ping (ping -f) sends a rapid stream of packets and can overwhelm target systems or networks, potentially violating legal or ethical guidelines.
        Use only on systems you own or have explicit permission to test. Unauthorized usage may be considered illegal.</p>
{% endblock %}

{% block scripts %}
    document.addEventListener("DOMContentLoaded", function () {
    const startButton = document.getElementById("start-button");
    const stopButton = document.getElementById("stop-button");
    const ipInput = document.getElementById("ip-input");
    const loading = document.getElementById("loading");
    const results = document.getElementById("results");
    let floodPingProcessId = null;

    function startScan() {
    const ip = ipInput.value.trim();
    if (!ip) {
    alert("Please enter a valid IP address.");
    return;
    }

    // Show loading animation and stop button
    loading.style.display = "block";
    stopButton.style.display = "inline-block";
    results.innerHTML = "";

    // Start flood ping
    fetch(`/api/flood_ping/start?ip=${encodeURIComponent(ip)}`)
    .then((response) => response.json())
    .then((data) => {
    if (data.success) {
    floodPingProcessId = data.processId; // Store the process ID
    results.innerHTML = `<p>Flood ping started for ${ip}</p>`;
    } else {
    loading.style.display = "none";
    stopButton.style.display = "none";
    results.innerHTML = `<p>Error: ${data.error}</p>`;
    }
    })
    .catch((error) => {
    loading.style.display = "none";
    stopButton.style.display = "none";
    results.innerHTML = `<p>Error: ${error.message}</p>`;
    });
    }

    function stopScan() {
    if (!floodPingProcessId) {
    alert("No flood ping process is running.");
    return;
    }

    // Stop flood ping
    fetch(`/api/flood_ping/stop?processId=${encodeURIComponent(floodPingProcessId)}`)
    .then((response) => response.json())
    .then((data) => {
    if (data.success) {
    loading.style.display = "none";
    stopButton.style.display = "none";
    results.innerHTML = `<p>Flood ping stopped.</p>`;
    floodPingProcessId = null; // Reset the process ID
    } else {
    results.innerHTML = `<p>Error: ${data.error}</p>`;
    }
    })
    .catch((error) => {
    results.innerHTML = `<p>Error: ${error.message}</p>`;
    });
    }

    // Event listeners
    startButton.addEventListener("click", startScan);
    stopButton.addEventListener("click", stopScan);
    });
{% endblock %}
